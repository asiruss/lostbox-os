<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="robots" content="noindex, nofollow">
<title>Калькулятор</title>
<style>
body {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  margin: 0;
}

input {
  width: 230px;
  height: 40px;
  margin-bottom: 10px;
  text-align: left;
  font-size: 1.2rem;
  color: #808080;
}

.button-row {
  display: flex;
  gap: 5px;
  margin-bottom: 5px;
  width: 240px;
  user-select: none;
}

.button-row button {
  flex: 1;
  height: 30px;
  font-size: 1.2rem;
}
</style>
</head>
<body>
<input type="text" id="display" readonly>
<div class="button-row">
  <button style="background-color: #808080; color: white;">1</button>
  <button style="background-color: #808080; color: white;">2</button>
  <button style="background-color: #808080; color: white;">3</button>
  <button style="background-color: #4CAF50; color: white;">+</button>
</div>
<div class="button-row">
  <button style="background-color: #808080; color: white;">4</button>
  <button style="background-color: #808080; color: white;">5</button>
  <button style="background-color: #808080; color: white;">6</button>
  <button style="background-color: #4CAF50; color: white;">-</button>
</div>
<div class="button-row">
  <button style="background-color: #808080; color: white;">7</button>
  <button style="background-color: #808080; color: white;">8</button>
  <button style="background-color: #808080; color: white;">9</button>
  <button style="background-color: #4CAF50; color: white;">×</button>
</div>
<div class="button-row">
  <button style="background-color: #E74C3C; color: white;">C</button>
  <button style="background-color: #808080; color: white;">0</button>
  <button style="background-color: #E74C3C; color: white;">←</button>
  <button style="background-color: #4CAF50; color: white;">÷</button>
</div>
<div class="button-row">
   <button style="background-color: #4CAF50; color: white;">^</button>
  <button style="background-color: #4CAF50; color: white;">!</button>
  <button style="background-color: #4CAF50; color: white;">%</button>
  <button style="background-color: #4CAF50; color: white;">=</button>
</div>
<script>
const display = document.getElementById('display');
const buttons = document.querySelectorAll('button');

// Функция для вычисления факториала
function factorial(n) {
  if (n < 0) return NaN;
  if (n === 0) return 1;
  let result = 1;
  for (let i = 2; i <= n; i++) {
    result *= i;
  }
  return result;
}

buttons.forEach(button => {
  button.addEventListener('click', () => {
    const buttonText = button.textContent;

    if (buttonText === 'C') {
      display.value = '';
    } else if (buttonText === '←') {
      display.value = display.value.slice(0, -1);
    } else if (buttonText === '=') {
      try {
        let expression = display.value
          .replace(/×/g, '*')
          .replace(/÷/g, '/');

        // Обработка возведения в степень (2^3)
        expression = expression.replace(/(\d+)\^(\d+)/g, (match, base, exp) => {
          return Math.pow(parseInt(base), parseInt(exp));
        });

        // Обработка факториала (5!)
        expression = expression.replace(/(\d+)!/g, (match, num) => {
          return factorial(parseInt(num));
        });

        // Обработка процентов (50%)
        expression = expression.replace(/(\d+(\.\d+)?)%/g, (match, num) => {
          return parseFloat(num) / 100;
        });

        display.value = eval(expression);
      } catch (e) {
        display.value = 'Ошибка';
      }
    } else {
      display.value += buttonText;
    }
  });
});
</script>
</body>
</html>
